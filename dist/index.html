<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>RetailEdge Pro | AI Stock Screener & Portfolio Tracker</title>
  <link rel="stylesheet" href="./tailwind.css">
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Tier 3 Libraries: ML & PDF Export -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.17.0/dist/tf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.11.0/math.min.js"></script>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <!-- PWA Manifest -->
  <link rel="manifest" href="#manifest-placeholder">
  <script type="application/json" id="manifest-placeholder">
  {
    "name": "RetailEdge Pro",
    "short_name": "RetailEdge",
    "start_url": "/",
    "display": "standalone",
    "background_color": "#020617",
    "theme_color": "#06b6d4",
    "icons": [
      { "src": "icon-192.png", "sizes": "192x192", "type": "image/png" },
      { "src": "icon-512.png", "sizes": "512x512", "type": "image/png" }
    ]
  }
  </script>

  <style>
    /* Theme Variables */
    :root {
      --bg-main: linear-gradient(135deg, #020617 0%, #0f172a 50%, #020617 100%);
      --bg-solid: #0f172a;
      --card-bg: rgba(30, 41, 59, 0.7);
      --card-border: rgba(100, 116, 139, 0.15);
      --text-main: #e2e8f0;
      --text-secondary: #94a3b8;
      --accent-primary: #06b6d4;
      --accent-secondary: #8b5cf6;
    }

    .light-mode {
      --bg-main: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 50%, #f1f5f9 100%);
      --bg-solid: #f8fafc;
      --card-bg: rgba(255, 255, 255, 0.9);
      --card-border: rgba(148, 163, 184, 0.25);
      --text-main: #1e293b;
      --text-secondary: #64748b;
      --accent-primary: #0891b2;
      --accent-secondary: #7c3aed;
    }

    /* Skeleton Loading Animation */
    @keyframes shimmer {
      0% {
        background-position: -1000px 0;
      }

      100% {
        background-position: 1000px 0;
      }
    }

    .skeleton {
      background: linear-gradient(90deg, #1e293b 25%, #334155 50%, #1e293b 75%);
      background-size: 1000px 100%;
      animation: shimmer 2s infinite linear;
      border-radius: 8px;
    }

    .light-mode .skeleton {
      background: linear-gradient(90deg, #e2e8f0 25%, #cbd5e1 50%, #e2e8f0 75%);
      background-size: 1000px 100%;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background: var(--bg-main);
      min-height: 100vh;
      font-family: 'Inter', sans-serif;
      color: #e2e8f0;
    }

    .font-mono {
      font-family: 'JetBrains Mono', monospace;
    }

    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }

    ::-webkit-scrollbar-track {
      background: #0f172a;
    }

    ::-webkit-scrollbar-thumb {
      background: #475569;
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #64748b;
    }

    /* Glassmorphism */
    .glass {
      background: rgba(15, 23, 42, 0.8);
      backdrop-filter: blur(16px);
      border: 1px solid rgba(100, 116, 139, 0.2);
    }

    .glass-card {
      background: linear-gradient(135deg, rgba(30, 41, 59, 0.7) 0%, rgba(15, 23, 42, 0.9) 100%);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(100, 116, 139, 0.15);
      transition: all 0.3s ease;
    }

    .glass-card:hover {
      border-color: rgba(6, 182, 212, 0.4);
      transform: translateY(-2px);
      box-shadow: 0 12px 40px rgba(6, 182, 212, 0.1);
    }

    .glass-elevated {
      background: rgba(30, 41, 59, 0.85);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(100, 116, 139, 0.25);
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
    }

    /* Animations */
    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 1;
      }

      50% {
        opacity: 0.5;
      }
    }

    @keyframes glow {

      0%,
      100% {
        box-shadow: 0 0 5px rgba(6, 182, 212, 0.3);
      }

      50% {
        box-shadow: 0 0 20px rgba(6, 182, 212, 0.6);
      }
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    /* Loading States */
    .data-loading {
      opacity: 0.7;
      pointer-events: none;
    }

    .data-loaded {
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from {
        opacity: 0.5;
      }

      to {
        opacity: 1;
      }
    }

    @keyframes slideInLeft {
      from {
        opacity: 0;
        transform: translateX(-20px);
      }

      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .animate-slide-up {
      animation: slideUp 0.4s ease-out;
    }

    .animate-fade-in {
      animation: fadeIn 0.3s ease;
    }

    .animate-pulse {
      animation: pulse 2s infinite;
    }

    .animate-glow {
      animation: glow 2s ease-in-out infinite;
    }

    .animate-spin {
      animation: spin 1s linear infinite;
    }

    .animate-slideInLeft {
      animation: slideInLeft 0.3s ease-out;
    }

    /* Table */
    .table-row {
      transition: all 0.15s ease;
      border-left: 3px solid transparent;
    }

    .table-row:hover {
      background: rgba(6, 182, 212, 0.06);
      cursor: pointer;
      border-left-color: rgba(6, 182, 212, 0.3);
    }

    .table-row.selected {
      background: rgba(6, 182, 212, 0.1);
      border-left-color: #06b6d4;
    }

    /* Modal */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(8px);
      z-index: 1000;
      overflow-y: auto;
    }

    /* Tabs */
    .tab-btn {
      padding: 12px 20px;
      font-size: 13px;
      font-weight: 600;
      border-bottom: 2px solid transparent;
      color: #64748b;
      transition: all 0.2s;
    }

    .tab-btn:hover {
      background: rgba(255, 255, 255, 0.03);
      color: #94a3b8;
    }

    .tab-btn.active {
      border-color: #06b6d4;
      color: #06b6d4;
    }

    /* ===== FIXED: Add underline-on-hover for fundamentals tab ===== */
    .fundamentals-tab {
      position: relative;
    }

    .fundamentals-tab:hover {
      background: rgba(255, 255, 255, 0.03);
    }

    .fundamentals-tab.active {
      border-color: #06b6d4;
      color: #06b6d4;
    }

    .fundamentals-content {
      display: none;
    }

    .fundamentals-content.active {
      display: block;
    }

    /* Chips & Badges */
    .chip {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 10px;
      border-radius: 9999px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.025em;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 8px;
      border-radius: 6px;
      font-size: 10px;
      font-weight: 700;
    }

    /* Sparkline */
    .sparkline {
      display: flex;
      align-items: flex-end;
      gap: 1px;
      height: 28px;
    }

    .sparkline-bar {
      width: 3px;
      border-radius: 1px;
      transition: height 0.3s;
    }

    /* Health & Progress Bars */
    .health-bar {
      height: 6px;
      border-radius: 3px;
      background: #1e293b;
      overflow: hidden;
    }

    .health-fill {
      height: 100%;
      border-radius: 3px;
      transition: width 0.5s ease;
    }

    /* Range Inputs */
    input[type=range] {
      -webkit-appearance: none;
      background: transparent;
      width: 100%;
    }

    input[type=range]::-webkit-slider-thumb {
      -webkit-appearance: none;
      height: 16px;
      width: 16px;
      border-radius: 50%;
      background: #06b6d4;
      cursor: pointer;
      margin-top: -6px;
      box-shadow: 0 2px 6px rgba(6, 182, 212, 0.4);
    }

    input[type=range]::-webkit-slider-runnable-track {
      width: 100%;
      height: 4px;
      background: #334155;
      border-radius: 2px;
    }

    /* Theme Pills */
    .theme-pill {
      padding: 8px 16px;
      border-radius: 24px;
      font-size: 13px;
      font-weight: 500;
      transition: all 0.2s;
      cursor: pointer;
      border: 1px solid transparent;
    }

    .theme-pill:hover {
      background: rgba(255, 255, 255, 0.05);
      border-color: rgba(100, 116, 139, 0.3);
    }

    .theme-pill.active {
      background: linear-gradient(135deg, rgba(6, 182, 212, 0.2), rgba(139, 92, 246, 0.2));
      border-color: rgba(6, 182, 212, 0.4);
      color: #06b6d4;
    }

    /* Tooltips */
    .tooltip {
      position: relative;
    }

    .tooltip-content {
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%) translateY(-8px);
      background: #1e293b;
      border: 1px solid #334155;
      border-radius: 8px;
      padding: 12px 16px;
      width: 280px;
      font-size: 12px;
      line-height: 1.6;
      opacity: 0;
      visibility: hidden;
      transition: all 0.2s;
      z-index: 100;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
      pointer-events: none;
    }

    .tooltip:hover .tooltip-content {
      opacity: 1;
      visibility: visible;
    }

    /* Verdict Styles */
    .verdict-bullish {
      background: linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, rgba(34, 197, 94, 0.02) 100%);
      border: 1px solid rgba(34, 197, 94, 0.3);
    }

    .verdict-bearish {
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(239, 68, 68, 0.02) 100%);
      border: 1px solid rgba(239, 68, 68, 0.3);
    }

    .verdict-neutral {
      background: linear-gradient(135deg, rgba(234, 179, 8, 0.1) 0%, rgba(234, 179, 8, 0.02) 100%);
      border: 1px solid rgba(234, 179, 8, 0.3);
    }

    /* Live Indicator */
    .live-dot {
      width: 8px;
      height: 8px;
      background: #22c55e;
      border-radius: 50%;
      animation: glow 2s ease-in-out infinite;
    }

    .live-indicator {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 8px;
      border-radius: 12px;
      background: rgba(34, 197, 94, 0.1);
      border: 1px solid rgba(34, 197, 94, 0.3);
      font-size: 10px;
      font-weight: 600;
      color: #22c55e;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .live-indicator.offline {
      background: rgba(148, 163, 184, 0.1);
      border-color: rgba(148, 163, 184, 0.3);
      color: #94a3b8;
    }

    .live-indicator.offline .live-dot {
      background: #94a3b8;
      animation: none;
    }

    /* Tournament Status Indicator */
    .tournament-status-indicator {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      background: rgba(15, 23, 42, 0.9);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(34, 197, 94, 0.3);
      border-radius: 12px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);
    }

    /* Preset Screen Cards */
    .preset-card {
      background: rgba(30, 41, 59, 0.5);
      border: 1px solid rgba(100, 116, 139, 0.2);
      border-radius: 10px;
      padding: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .preset-card:hover {
      border-color: #06b6d4;
      background: rgba(6, 182, 212, 0.05);
    }

    .preset-card.active {
      border-color: #06b6d4;
      background: rgba(6, 182, 212, 0.1);
    }

    /* Column Selector */
    .column-toggle {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 6px 10px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.15s;
    }

    .column-toggle:hover {
      background: rgba(255, 255, 255, 0.05);
    }

    .column-toggle.active {
      background: rgba(6, 182, 212, 0.15);
    }

    /* P&L Colors */
    .pnl-positive {
      color: #22c55e;
    }

    .pnl-negative {
      color: #ef4444;
    }

    .pnl-neutral {
      color: #94a3b8;
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       MOBILE RESPONSIVE STYLES - PHASE 1 ENHANCED
       ═══════════════════════════════════════════════════════════════════════════ */

    @media (max-width: 768px) {

      /* Hide desktop table, show mobile cards */
      .stock-table-container {
        display: none;
      }

      .mobile-stock-cards {
        display: block !important;
      }

      /* Stock cards for mobile */
      .stock-card {
        background: rgba(30, 41, 59, 0.8);
        border: 1px solid rgba(100, 116, 139, 0.2);
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 12px;
        cursor: pointer;
        transition: all 0.2s;
      }

      .stock-card:hover {
        background: rgba(30, 41, 59, 0.95);
        border-color: rgba(6, 182, 212, 0.5);
        transform: translateY(-2px);
      }

      .stock-card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
        padding-bottom: 12px;
        border-bottom: 1px solid rgba(100, 116, 139, 0.2);
      }

      .stock-card-symbol {
        font-size: 20px;
        font-weight: 700;
        color: #06b6d4;
      }

      .stock-card-price {
        font-size: 18px;
        font-weight: 700;
        color: #fff;
      }

      .stock-card-change {
        font-size: 14px;
        font-weight: 600;
      }

      .stock-card-metrics {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
        margin-top: 12px;
      }

      .stock-card-metric {
        font-size: 12px;
      }

      .stock-card-metric-label {
        color: #94a3b8;
        font-size: 11px;
        margin-bottom: 4px;
      }

      .stock-card-metric-value {
        color: #fff;
        font-weight: 600;
        font-size: 14px;
      }

      .stock-card-verdict {
        margin-top: 12px;
        padding-top: 12px;
        border-top: 1px solid rgba(100, 116, 139, 0.2);
        text-align: center;
      }

      /* Larger tap targets */
      button,
      .tab-btn,
      a.button {
        min-height: 44px;
        padding: 12px 16px;
        font-size: 14px;
      }

      /* Full screen modals on mobile */
      .modal-overlay {
        padding: 0;
      }

      .modal-content {
        width: 100vw;
        height: 100vh;
        max-height: 100vh;
        max-width: 100vw;
        border-radius: 0;
        margin: 0;
      }

      .modal-header {
        position: sticky;
        top: 0;
        z-index: 10;
        background: rgba(15, 23, 42, 0.98);
        backdrop-filter: blur(20px);
      }

      .modal-body {
        padding: 16px;
        padding-bottom: 80px;
        /* Space for bottom nav */
      }

      /* Bottom navigation for mobile */
      .mobile-bottom-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: rgba(15, 23, 42, 0.98);
        backdrop-filter: blur(20px);
        border-top: 1px solid rgba(100, 116, 139, 0.2);
        padding: 8px;
        display: flex;
        justify-content: space-around;
        z-index: 1000;
        box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
      }

      .mobile-nav-btn {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 4px;
        padding: 8px 16px;
        border-radius: 8px;
        font-size: 11px;
        color: #94a3b8;
        background: transparent;
        border: none;
        cursor: pointer;
        transition: all 0.2s;
      }

      .mobile-nav-btn.active {
        background: rgba(6, 182, 212, 0.15);
        color: #06b6d4;
      }

      .mobile-nav-icon {
        font-size: 20px;
      }

      /* Export buttons stack on mobile */
      .export-buttons {
        flex-direction: column;
        gap: 8px;
      }

      .export-buttons button {
        width: 100%;
      }

      /* Filters take full width */
      .filters-container {
        flex-direction: column;
      }

      .filter-group {
        width: 100%;
      }
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       GOAL PLANNER SPECIFIC STYLES
       ═══════════════════════════════════════════════════════════════════════════ */

    .glass-goal-card {
      background: linear-gradient(135deg, rgba(30, 41, 59, 0.7) 0%, rgba(15, 23, 42, 0.9) 100%);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(100, 116, 139, 0.15);
      border-radius: 16px;
      transition: all 0.3s ease;
    }

    .glass-goal-card:hover {
      border-color: rgba(6, 182, 212, 0.4);
      transform: translateY(-2px);
      box-shadow: 0 12px 40px rgba(6, 182, 212, 0.1);
    }

    .goal-progress-ring {
      transform: rotate(-90deg);
      transform-origin: 50% 50%;
    }

    .goal-milestone {
      position: relative;
    }

    .goal-milestone::before {
      content: '';
      position: absolute;
      left: 50%;
      top: 100%;
      width: 1px;
      height: 20px;
      background: linear-gradient(to bottom, rgba(6, 182, 212, 0.5), transparent);
    }

    .goal-input-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
    }

    .goal-results-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 16px;
    }

    .goal-action-buttons {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    /* Animation for goal completion */
    @keyframes goalComplete {
      0% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.05);
      }

      100% {
        transform: scale(1);
      }
    }

    .goal-complete-animation {
      animation: goalComplete 0.5s ease-in-out;
    }

    /* Tooltip styles for goal explanations */
    .goal-tooltip {
      position: relative;
      display: inline-block;
      cursor: help;
    }

    .goal-tooltip .tooltip-content {
      visibility: hidden;
      position: absolute;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      background: #1e293b;
      border: 1px solid #334155;
      border-radius: 8px;
      padding: 12px;
      width: 300px;
      font-size: 12px;
      line-height: 1.5;
      z-index: 100;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .goal-tooltip:hover .tooltip-content {
      visibility: visible;
    }

    /* Print styles for goal PDF export */
    @media print {
      .goal-planner-print {
        background: white !important;
        color: black !important;
      }

      .goal-planner-print .glass-card {
        background: #f8fafc !important;
        border: 1px solid #e2e8f0 !important;
        color: #1e293b !important;
      }

      .no-print {
        display: none !important;
      }
    }

    @media (min-width: 769px) {
      .mobile-stock-cards {
        display: none;
      }

      .mobile-bottom-nav {
        display: none;
      }
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       AI TOURNAMENT STATUS INDICATOR
       ═══════════════════════════════════════════════════════════════════════════ */

    .tournament-live-indicator {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      background: rgba(15, 23, 42, 0.9);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(34, 197, 94, 0.3);
      border-radius: 12px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);
      animation: pulse 2s infinite;
    }

    .tournament-live-indicator .live-dot {
      width: 8px;
      height: 8px;
      background: #22c55e;
      border-radius: 50%;
      animation: glow 2s ease-in-out infinite;
    }
  </style>
</head>

<body>
  <div id="root"></div>

  <!-- Firebase Authentication (Optional) -->
  <script type="module">
    // Firebase config - replace with your own or leave as demo mode
    try {
      const { initializeApp } = await import("https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js");
      const { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } = await import("https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js");
      const { getFirestore, doc, setDoc, getDoc } = await import("https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js");

      const firebaseConfig = {
        apiKey: "DEMO_MODE",
        authDomain: "demo.firebaseapp.com",
        projectId: "demo-project"
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const db = getFirestore(app);
      const provider = new GoogleAuthProvider();

      window.firebaseUtils = { auth, db, provider, signInWithPopup, onAuthStateChanged, doc, setDoc, getDoc };
      console.log('✅ Firebase initialized (demo mode)');
    } catch (error) {
      console.log('ℹ️ Firebase not configured - running in guest mode');
      window.firebaseUtils = null;
    }
  </script>
  <script src="./config.js"></script>
  <script src="./vendor/react.production.min.js"></script>
  <script src="./vendor/react-dom.production.min.js"></script>
  <script src="./vendor/lightweight-charts.standalone.production.js"></script>
  <script src="./app.js"></script>

  <!-- Technical Analysis Features -->
  <script src="../technical-analysis-engine.js"></script>
  <script src="../technical-analysis-ui.js"></script>
  <script src="../technical-analysis-integration.js"></script>

  <!-- Fix Script: Enrich Stock Data with FMP API -->
  <script src="../fix-stock-columns.js"></script>
</body>

</html>